import time
import os

GPIO_PIN = 15  # Chân GPIO PWM15-M2

# Thiết lập GPIO
os.system(f"gpio mode {GPIO_PIN} out")

def send_bit(bit):
    """Gửi 1 bit (0 hoặc 1) đến LED."""
    if bit:  # Gửi bit 1
        os.system(f"gpio write {GPIO_PIN} 1")
        time.sleep(0.0000008)  # HIGH 800ns
        os.system(f"gpio write {GPIO_PIN} 0")
        time.sleep(0.00000045)  # LOW 450ns
    else:  # Gửi bit 0
        os.system(f"gpio write {GPIO_PIN} 1")
        time.sleep(0.0000004)  # HIGH 400ns
        os.system(f"gpio write {GPIO_PIN} 0")
        time.sleep(0.00000085)  # LOW 850ns

def send_color(red, green, blue):
    """Gửi màu (RGB) đến 1 LED."""
    for i in range(8):
        send_bit((green >> (7 - i)) & 1)  # Gửi từng bit của Green
    for i in range(8):
        send_bit((red >> (7 - i)) & 1)  # Gửi từng bit của Red
    for i in range(8):
        send_bit((blue >> (7 - i)) & 1)  # Gửi từng bit của Blue

def test_led():
    """Test dải LED với các màu cơ bản."""
    send_color(255, 0, 0)  # Đỏ
    time.sleep(1)
    send_color(0, 255, 0)  # Xanh lá
    time.sleep(1)
    send_color(0, 0, 255)  # Xanh dương
    time.sleep(1)

# Chạy chương trình
if __name__ == "__main__":
    try:
        while True:
            test_l
    except KeyboardInterrupt:
        os.system(f"gpio write {GPIO_PIN} 0")  # Tắt LED khi thoát

